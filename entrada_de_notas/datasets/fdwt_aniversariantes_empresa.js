function createDataset(a,e,t){log.info("@@ Inicio | Dataset | fdwt_v2_aniversariantes.js");var n="",r="",o="",i="",s="",l="",u="",m="",c="";if(null!=e)for(var p=0;p<e.length;p++)"c_serverUrl"==e[p].fieldName&&(n=e[p].initialValue),"c_contextPath"==e[p].fieldName&&(r=e[p].initialValue),"c_tenantCode"==e[p].fieldName&&(o=e[p].initialValue),"c_consideraCargo"==e[p].fieldName&&(i=e[p].initialValue),"c_consideraDepartamento"==e[p].fieldName&&(s=e[p].initialValue),"c_consideraUnidade"==e[p].fieldName&&(l=e[p].initialValue),"c_consideraEmpresa"==e[p].fieldName&&(u=e[p].initialValue),"c_limit"==e[p].fieldName&&(m=e[p].initialValue),"c_mes"==e[p].fieldName&&(c=e[p].initialValue);var d=preparaDataset(),g=escolheCampos(),C=defineConstraints(i,s,l,u,m,c),D=DatasetFactory.getDataset("fdwt_campos_adicionais_usuario",g,C,["dataInicioEmpresaDia"]);if(null!=D&&D.rowsCount>0)for(p=0;p<D.rowsCount;p++){var f=getDadosColleague(D.getValue(p,"matricula"),D.getValue(p,"email"),D.getValue(p,"login"),n,r,o);if(null!=f){var v=D.getValue(p,"matricula"),y=getNomeCargo(D.getValue(p,"cargo")),h=D.getValue(p,"login"),T=getNomeEmpresa(D.getValue(p,"empresa")),I=D.getValue(p,"metadata#id"),V=D.getValue(p,"metadata#version"),U=D.getValue(p,"nomeCompleto"),M=D.getValue(p,"email"),_=getNomeDepartamento(D.getValue(p,"departamento")),F=getNomeUnidade(D.getValue(p,"unidade")),N=f.linkImg,E=f.linkPerfil,S=f.buscarImg,w=D.getValue(p,"dataInicioEmpresaDia"),j=D.getValue(p,"dataInicioEmpresaMes");d.addRow(new Array(v,y,h,T,I,V,U,M,_,F,N,E,S,w,j))}}return log.info("@@ BeforeReturn | Dataset | fdwt_v2_aniversariantes.js"),d}function getNomeCargo(a){var e="";if(mapCargo.containsKey(a))e=mapCargo.get(a);else{var t=[];t.push(DatasetFactory.createConstraint("cargoId",a,a,ConstraintType.MUST));var n=DatasetFactory.getDataset("fdwt_estrutura_empresa_cargo",["cargoNome","cargoId"],t,null);if(null!=n&&n.values&&n.values.length>0){var r=n.getValue(0,"cargoId"),o=n.getValue(0,"cargoNome");mapCargo.put(r,o),e=o}}return e}function getNomeEmpresa(a){var e="";if(mapEmpresa.containsKey(a))e=mapEmpresa.get(a);else{var t=[];t.push(DatasetFactory.createConstraint("empresaId",a,a,ConstraintType.MUST));var n=DatasetFactory.getDataset("fdwt_empresas",["descricao","empresaId"],t,null);if(null!=n&&n.values&&n.values.length>0){var r=n.getValue(0,"empresaId"),o=n.getValue(0,"descricao");mapEmpresa.put(r,o),e=o}}return e}function getNomeDepartamento(a){var e="";if(mapDepartamento.containsKey(a))e=mapDepartamento.get(a);else{var t=[];t.push(DatasetFactory.createConstraint("estruturaId",a,a,ConstraintType.MUST));var n=DatasetFactory.getDataset("fdwt_estrutura_empresa",["estruturaNome","estruturaId"],t,null);if(null!=n&&n.values&&n.values.length>0){var r=n.getValue(0,"estruturaId"),o=n.getValue(0,"estruturaNome");mapDepartamento.put(r,o),e=o}}return e}function getNomeUnidade(a){var e="";if(mapUnidade.containsKey(a))e=mapUnidade.get(a);else{var t=[];t.push(DatasetFactory.createConstraint("lojaCodigo",a,a,ConstraintType.MUST));var n=DatasetFactory.getDataset("fdwt_lojas",["lojaNome","lojaCodigo"],t,null);if(null!=n&&n.values&&n.values.length>0){var r=n.getValue(0,"lojaCodigo"),o=n.getValue(0,"lojaNome");mapUnidade.put(r,o),e=o}}return e}function getDadosColleague(a,e,t,n,r,o){var i=null;if(null!=a&&""!=a&&"."!=a&&" "!=a){var s=[];s.push(DatasetFactory.createConstraint("active",!0,!0,ConstraintType.MUST)),s.push(DatasetFactory.createConstraint("colleaguePK.colleagueId",a,a,ConstraintType.SHOULD)),s.push(DatasetFactory.createConstraint("mail",e,e,ConstraintType.SHOULD)),s.push(DatasetFactory.createConstraint("login",t,t,ConstraintType.SHOULD));var l=DatasetFactory.getDataset("colleague",["active","login"],s,null);null!=l&&l.rowsCount>0&&(i={},i.linkImg=n+"/api/public/profile/image/"+l.getValue(0,"login")+"/MEDIUM_PICTURE",i.linkPerfil=n+r+"/"+o+"/social/"+l.getValue(0,"login"),i.buscarImg=!1)}else i=colocaImgPadrao(n);return i}function colocaImgPadrao(a){var e={};return e.linkImg=a+"/api/public/profile/image/usuario_inexistente/MEDIUM_PICTURE",e.linkPerfil="",e.buscarImg=!0,e}function preparaDataset(){var a=DatasetBuilder.newDataset();return a.addColumn("matricula"),a.addColumn("nomeCargo"),a.addColumn("login"),a.addColumn("nomeEmpresa"),a.addColumn("idFicha"),a.addColumn("versaoFicha"),a.addColumn("nomeCompleto"),a.addColumn("email"),a.addColumn("nomeDepartamento"),a.addColumn("nomeUnidade"),a.addColumn("linkImg"),a.addColumn("linkPerfil"),a.addColumn("buscarImg"),a.addColumn("dataInicioEmpresaDia"),a.addColumn("dataInicioEmpresaMes"),a}function escolheCampos(){var a=[];return a.push("matricula"),a.push("cargo"),a.push("login"),a.push("empresa"),a.push("metadata#id"),a.push("metadata#version"),a.push("nomeCompleto"),a.push("email"),a.push("departamento"),a.push("unidade"),a.push("dataInicioEmpresa"),a.push("dataInicioEmpresaDia"),a.push("dataInicioEmpresaMes"),a}function defineConstraints(a,e,t,n,r,o){var i=[],s=(new Date).getUTCMonth()+1,l=(new Date).getUTCDate(),u="0"==o?s:o,m="0"==o?l:1,c=u?("00"+u).slice(-2):"",p=m?("00"+m).slice(-2):"";return i.push(DatasetFactory.createConstraint("metadata#active",!0,!0,ConstraintType.MUST)),i.push(DatasetFactory.createConstraint("dataInicioEmpresaDia","","",ConstraintType.MUST_NOT)),i.push(DatasetFactory.createConstraint("dataInicioEmpresaMes","","",ConstraintType.MUST_NOT)),i.push(DatasetFactory.createConstraint("dataInicioEmpresaMes",c,c,ConstraintType.MUST)),i.push(DatasetFactory.createConstraint("dataInicioEmpresaDia",p,"31",ConstraintType.MUST)),null!=a&&""!=a&&i.push(DatasetFactory.createConstraint("cargo",a,a,ConstraintType.MUST)),null!=e&&""!=e&&i.push(DatasetFactory.createConstraint("departamento",e,e,ConstraintType.MUST)),null!=t&&""!=t&&i.push(DatasetFactory.createConstraint("unidade",t,t,ConstraintType.MUST)),null!=n&&""!=n&&i.push(DatasetFactory.createConstraint("empresa",n,n,ConstraintType.MUST)),null!=r&&""!=r&&i.push(DatasetFactory.createConstraint("sqlLimit",r,r,ConstraintType.MUST)),i}function defineStructure(){}function onSync(a){}function onMobileSync(a){}var mapCargo=new java.util.HashMap,mapDepartamento=new java.util.HashMap,mapUnidade=new java.util.HashMap,mapEmpresa=new java.util.HashMap;